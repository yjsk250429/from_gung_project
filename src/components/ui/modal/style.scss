@use '../../../styles/base' as *;
@use '../../../styles/utils' as *;
@use '../../../styles/ui/modal' as *;
@use '../../../styles/ui/input' as *;

.modal-overlay {
    @include overlay;
    .modal {
        @include modalLayout;
        position: relative;
        &.ottReviewDetail {
            width: vw(500);
            height: vw(450);
            padding: vw(50);
            box-sizing: border-box;
            position: relative;
            background: #000;
            border: 1px solid $white;
        }
        &.tourReviewDetail {
            width: vw(500);
            height: vw(400);
            padding: vw(50);
            box-sizing: border-box;
            position: relative;
            &::after {
                content: '';
                width: vw(464);
                height: vw(366);
                display: block;
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background-image: url('/images/components/review_detail_frame.png');
                background-repeat: no-repeat;
                background-position: 50% 50%;
                opacity: 0.1;
                z-index: -1;
            }
            .top {
                display: flex;
                align-items: center;
                gap: vw(20);
                margin-bottom: vw(20);
                .profile-wrap {
                    width: vw(80);
                    height: vw(80);
                    img {
                        width: 100%;
                        height: 100%;
                    }
                }
                .name-wrap {
                    strong {
                        display: block;
                        margin-bottom: vw(8);
                        @include font-18px;
                    }
                    .date {
                        color: #666;
                        display: block;
                        @include font-14px;
                    }
                    .stars {
                        @include font-16px;
                        color: #666;
                        span {
                            margin-left: vw(-1);
                            color: $sub3;
                        }
                    }
                }
            }
            .bottom {
                .edit {
                    display: flex;
                    justify-content: flex-end;
                    gap: vw(14);
                    margin-bottom: vw(10);
                    li {
                        @include font-15px;
                        color: #666;
                        position: relative;
                        cursor: pointer;
                        &:first-child {
                            &::after {
                                content: '';
                                display: block;
                                width: 1px;
                                height: vw(14);
                                background: #666;
                                position: absolute;
                                right: vw(-8);
                                top: 50%;
                                transform: translateY(-50%);
                            }
                        }
                    }
                }
                .textarea-wrap {
                    position: relative;
                    .content-edit {
                        width: 100%;
                        height: vw(140);
                        border: vw(1) solid #ccc;
                        border-radius: vw(4);
                        padding: vw(8);
                        @include font-14px;
                        outline: none;
                        &:focus {
                            border-color: #333;
                        }
                    }
                    .char-count {
                        position: absolute;
                        @include font-14px;
                        right: vw(8);
                        bottom: vw(12);
                        color: #999;
                    }
                }
                .content {
                    @include font-18px;
                    height: vw(150);
                }
            }
            .btns {
            }
        }
        &.coupon {
            position: absolute;
            right: vw(160);
            bottom: vw(150);
            width: vw(520);
            height: vw(360);
            padding: vw(20);
            box-sizing: border-box;
            .close {
                position: absolute;
                right: vw(20);
                top: vw(20);
                cursor: pointer;
            }
            .box {
                border: 1px solid $sub1;
                display: flex;
                margin-top: vw(34);
                border-radius: vw(20);
                justify-content: space-between;
                align-items: center;
                .left {
                    padding: vw(20);
                    box-sizing: border-box;
                    em {
                        color: $sub3;
                        @include font-18px-B;
                    }
                    strong {
                        margin-top: vw(4);
                        margin-bottom: vw(10);
                        display: block;
                    }
                    span {
                        color: #999;
                        @include font-14px;
                        display: block;
                    }
                    .alreadyHas {
                        @include font-18px-B;
                        margin-top: vw(-14);
                        margin-bottom: vw(8);
                        color: $sub3;
                    }
                }
                .right {
                    cursor: pointer;
                    border-radius: 50%;
                    background: $sub3;
                    width: vw(40);
                    height: vw(40);
                    display: flex;
                    justify-content: center;
                    align-items: flex-end;
                    margin-right: vw(20);
                    i {
                        color: $white;
                    }
                    &.disabled {
                        background: #b1b1b1;
                        cursor: auto;
                        i {
                        }
                    }
                }
            }
            ul {
                margin: vw(10) 0 vw(25) vw(10);
                li {
                    @include font-14px;
                    padding-left: vw(10);
                    position: relative;
                    &::before {
                        content: '';
                        display: block;
                        width: vw(3);
                        height: vw(3);
                        border-radius: 50%;
                        background: #000;
                        position: absolute;
                        top: 50%;
                        transform: translateY(-50%);
                        left: 0;
                    }
                }
            }
            .btns {
                display: flex;
                justify-content: center;
            }
        }
        &.logoutComplete,
        &.withdrawComplete,
        &.editInfoComplete,
        &.needLogin,
        &.wishModal {
            @include confirm;
            background-image: url('/images/components/bg_flower.png');
            background-size: 80%;
            background-position: 210% 230%;
            .button {
                margin-top: 0;
            }
        }
        &.loginComplete {
            width: min(92vw, vw(320));
            padding: vw(35.2) vw(32) vw(41.6);
            background: #fff;
            color: #000;
            border-radius: vw(14);
            text-align: center;
            box-shadow: 0 vw(10) vw(30) rgba(0, 0, 0, 0.45);

            h3 {
                margin: 0 0 vw(4);
                font-weight: 700;
                font-size: vw(20);
            }
            .subtitle {
                display: block;
                opacity: 0.95;
                font-size: vw(15.2);
                margin-bottom: vw(20);
            }

            .stamp-wrap {
                position: relative;
                margin: 0 auto;
                width: vw(160);
                height: vw(160);
                pointer-events: none;

                /* 컨테이너 자체의 '찍힘' 탄성 */
                &.is-stamped {
                    animation: slam-bounce 0.22s ease-out both;
                }
            }

            .stamp {
                position: absolute;
                inset: 0;
                width: 100%;
                height: 100%;
                object-fit: contain;
                user-select: none;
                transform-origin: 50% 55%;
                will-change: transform, opacity, filter;
            }

            /* 기본 인쇄(옅은 잉크) : 항상 보이되, 찍히는 순간 사라짐 */
            .stamp--base {
                opacity: 0.95;
                filter: none;
            }
            .stamp-wrap.is-stamped .stamp--base {
                animation: base-press 0.12s ease-out forwards;
            }

            /* 찍힌 인쇄(선명) : 찍히는 순간에만 빠르게 나타남 */
            .stamp--on {
                opacity: 0;
                transform: scale(0.96);
                filter: blur(vw(0.5));
            }
            .stamp-wrap.is-stamped .stamp--on {
                animation: on-appear 0.18s cubic-bezier(0.2, 0.9, 0.25, 1) 0.02s forwards;
            }

            /* 충격파 링 */
            .ring {
                position: absolute;
                inset: 0;
                border-radius: 50%;
                border: vw(2) solid rgba(213, 216, 43, 1);
                transform: scale(0.7);
                opacity: 0;
            }
            .stamp-wrap.is-stamped .ring {
                animation: ring-pop 0.28s ease-out 0.02s forwards;
            }

            /* 잉크 번짐(안쪽 밝음 → 바깥쪽 0) */
            .ink {
                position: absolute;
                inset: 0;
                border-radius: 50%;
                background: radial-gradient(
                    closest-side,
                    rgba(255, 255, 255, 0.18),
                    rgba(255, 255, 255, 0)
                );
                opacity: 0;
                transform: scale(0.6);
            }
            .stamp-wrap.is-stamped .ink {
                animation: ink-spread 0.35s ease-out 0.03s forwards;
            }
        }

        /* --- keyframes: '쾅' 하고 찍힘 --- */
        @keyframes slam-bounce {
            0% {
                transform: scale(1) rotate(0);
            }
            45% {
                transform: scale(0.92, 0.88) rotate(-1.2deg);
            }
            100% {
                transform: scale(1) rotate(0);
            }
        }
        @keyframes base-press {
            0% {
                transform: scale(1);
                opacity: 0.95;
                filter: none;
            }
            100% {
                transform: scale(0.92);
                opacity: 0;
                filter: blur(vw(1));
            }
        }
        @keyframes on-appear {
            0% {
                transform: scale(0.9);
                opacity: 0;
                filter: blur(vw(1));
            }
            70% {
                transform: scale(1.06);
                opacity: 1;
                filter: blur(0);
            }
            100% {
                transform: scale(1);
                opacity: 1;
                filter: none;
            }
        }
        @keyframes ring-pop {
            0% {
                transform: scale(0.7);
                opacity: 0;
            }
            60% {
                transform: scale(1.1);
                opacity: 0.9;
            }
            100% {
                transform: scale(1.18);
                opacity: 0;
            }
        }
        @keyframes ink-spread {
            0% {
                opacity: 0;
                transform: scale(0.6);
            }
            70% {
                opacity: 0.85;
                transform: scale(1.05);
            }
            100% {
                opacity: 0;
                transform: scale(1.15);
            }
        }

        ///////////////////////////////////
        ///
        ///
        &.stampNotice {
            @include stampPopup;
            background-image: url('/images/components/frame.png');
            background-repeat: no-repeat;
        }
        &.editInfo {
            background-image: url('/images/components/bg_flower.png');
            background-position: -35% -23%;
            @include infoInputs;
            background-color: $main1;
            color: $white;
            h3 {
                margin-bottom: vw(50);
            }
            dl {
                display: flex;
                justify-content: flex-start;
                gap: vw(24);
                margin-bottom: vw(30);
                @include font-16px;
                &:first-of-type {
                    margin-left: vw(118);
                }
                &:last-of-type {
                    margin-left: vw(130);
                }
            }
            form {
                label {
                    text-align: right;
                    margin-right: vw(100);
                    display: block;
                    @include font-16px;
                    margin-bottom: vw(40);
                    &:last-of-type {
                        text-align: left;
                        margin-left: vw(140);
                        input[type='checkbox'] {
                            margin-right: vw(24);
                        }
                        span {
                            color: $sub3;
                        }
                        p {
                            @include font-14px;
                            position: absolute;
                            left: vw(230);
                            font-weight: 300;
                            color: #b1b1b1;
                        }
                    }
                    &:nth-child(4) {
                        select {
                            width: vw(70);
                            border: 1px solid #b1b1b1;
                            border-radius: vw(4);
                            height: vw(35);
                            padding-left: vw(4);
                            @include font-15px;
                            margin-left: vw(24);
                            margin-right: vw(8);
                        }
                        input[type='text'] {
                            width: vw(70);
                            margin-left: vw(8);
                            &:not(:last-child) {
                                margin-right: vw(8);
                            }
                        }
                    }
                    &:nth-child(5) {
                        margin-bottom: vw(50);
                        select {
                            width: vw(55);
                            border: 1px solid #b1b1b1;
                            border-radius: vw(4);
                            height: vw(35);
                            padding-left: vw(4);
                            @include font-15px;
                            margin-right: vw(4);
                            margin-left: vw(12);
                            &:first-child {
                                width: vw(70);
                                margin-left: vw(24);
                            }
                        }
                    }
                    input[type='text'],
                    input[type='password'] {
                        @include inputStyle;
                        margin-left: vw(24);
                    }
                    .error-message {
                        @include font-14px;
                        color: $sub3;
                        position: absolute;
                        left: vw(235);
                        margin-top: vw(4);
                    }
                    .success-message {
                        @include font-14px;
                        color: $light-green;
                        position: absolute;
                        left: vw(235);
                        margin-top: vw(4);
                    }
                }
                .btns {
                    margin-top: vw(75);
                    display: flex;
                    justify-content: center;
                    gap: vw(8);
                }
            }
        }
        &.joinComplete,
        &.withdrawConfirm,
        &.editPassword {
            background-image: url('/images/components/bg_flower.png');
            @include complete;
            text-align: center;
            background-size: 75%;
            background-position: 200% 600%;
            em {
                display: block;
                color: $sub3;
                margin-top: vw(30);
                margin-bottom: vw(-20);
            }
            input[type='password'] {
                @include inputStyle;
                margin-top: vw(10);
                margin-bottom: vw(-10);
            }
            .error-message {
                @include font-14px;
                color: $sub3;
                position: absolute;
                left: vw(60);
                margin-top: vw(4);
            }
            .btns {
                margin-top: vw(40);
                display: flex;
                gap: vw(8);
                justify-content: center;
            }
        }
        &.joinInfo {
            background-image: url('/images/components/bg_flower.png');
            background-position: -40% -25%;
            @include infoInputs;
            h3 {
                margin-bottom: vw(80);
                position: relative;
                span {
                    position: absolute;
                    right: 0;
                    bottom: 0;
                    @include font-16px;
                    font-weight: 400;
                }
            }
            form {
                label {
                    position: relative;
                    text-align: right;
                    margin-right: vw(120);
                    display: block;
                    @include font-16px;
                    margin-bottom: vw(36);
                    &:nth-child(3) {
                        .idcheck {
                            position: absolute;
                            width: vw(65);
                            @include font-14px;
                            font-family: $font-main;
                            border: 1px solid #b1b1b1;
                            background: #efefef;
                            height: vw(35);
                            border-radius: vw(4);
                            margin-left: vw(6);
                        }
                    }
                    &:nth-child(6) {
                        select {
                            width: vw(70);
                            border: 1px solid #b1b1b1;
                            border-radius: vw(4);
                            height: vw(35);
                            padding-left: vw(4);
                            @include font-15px;
                            margin-left: vw(24);
                            margin-right: vw(8);
                        }
                        input[type='text'] {
                            width: vw(70);
                            margin-left: vw(8);
                            &:not(:last-child) {
                                margin-right: vw(8);
                            }
                        }
                    }
                    &:nth-child(7) {
                        margin-right: vw(118);
                        select {
                            width: vw(55);
                            border: 1px solid #b1b1b1;
                            border-radius: vw(4);
                            height: vw(35);
                            padding-left: vw(4);
                            @include font-15px;
                            margin-right: vw(4);
                            margin-left: vw(12);
                            &:first-child {
                                width: vw(70);
                                margin-left: vw(24);
                            }
                        }
                    }

                    input[type='text'],
                    input[type='password'] {
                        @include inputStyle;
                        margin-left: vw(24);
                    }
                    .error-message,
                    .info-message {
                        @include font-14px;
                        color: $sub3;
                        position: absolute;
                        left: vw(160);
                    }
                    .idcheck-message {
                        @include font-14px;
                        color: $sub3; // 기본은 에러색
                        position: absolute;
                        left: vw(160);
                        &.success {
                            color: $light-green; // 성공 시 초록색
                        }
                    }
                    .pw-message {
                        @include font-14px;
                        position: absolute;
                        left: vw(160);
                        &.success {
                            color: $light-green; // 성공 시 초록색
                        }

                        &.error {
                            color: $sub3; // 불일치할 때 기존 에러색
                        }
                    }
                }
                .btns {
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    gap: vw(8);
                    position: absolute;
                    left: 50%;
                    transform: translateX(-50%);
                    bottom: vw(35);
                }
            }
            input.error,
            select.error {
                border: 1px solid $sub3 !important;
            }
            input.shake {
                animation: shake 0.3s ease;
            }

            input[class*='shake-'],
            select[class*='shake-'] {
                animation: shake 0.3s ease;
            }

            .required {
                @include font-16px;
                color: $sub3;
                text-align: center;
            }
        }
        &.login {
            @include login-agree;
            position: relative;
            h3 {
                text-align: center;
                margin-bottom: vw(20);
            }
            label {
                @include font-16px;
                input[type='text'],
                input[type='password'] {
                    display: block;
                    @include inputStyle;
                    margin: auto;
                    &.error-input {
                        border: 1px solid $sub3 !important;
                        animation: shake 0.3s ease;
                    }
                }
                input[type='text'] {
                    margin-bottom: vw(4);
                }
                .error {
                    color: $sub3;
                    @include font-14px;
                }
            }
            .findId {
                display: flex;
                justify-content: space-between;
                margin-bottom: vw(24);
                margin-top: vw(8);
                color: #616161;
                label {
                    @include font-15px;
                    input[type='checkbox'] {
                        margin-right: vw(4);
                    }
                }
                span {
                    @include font-14px;
                }
            }
            .btns {
                display: flex;
                justify-content: center;
                align-items: center;
                gap: vw(8);
            }
            .bottom {
                margin-top: vw(40);
                display: flex;
                justify-content: space-between;
                align-items: center;
                li {
                    @include font-16px-SB;
                    cursor: pointer;
                    &:first-child {
                        display: flex;
                        align-items: center;
                        color: #3c1e1e;
                        background: #fee500;
                        padding: vw(8) vw(16);
                        border-radius: vw(4);
                        img {
                            margin-right: vw(8);
                        }
                    }
                    &:last-child {
                        text-decoration: underline;
                        color: #616161;
                    }
                }
            }
        }

        &.joinAgree {
            background-image: url('/images/components/bg_tree.png');
            background-position: 100% 10%;
            @include login-agree;
            h3 {
                margin-bottom: vw(20);
            }
            form {
                label {
                    display: block;
                    span {
                        color: $main1;
                        @include font-16px-SB;
                    }
                    input[type='checkbox'] {
                        margin-right: vw(8);
                    }
                    &:first-child {
                        margin-bottom: vw(18);
                        @include font-18px-SB;
                    }

                    &:not(:first-child) {
                        @include font-16px;
                        margin-bottom: vw(20);
                        text-indent: vw(10);
                    }
                }
                .error-message {
                    color: $sub3;
                    text-align: center;
                    @include font-16px;
                    animation: shake 0.3s ease;
                    margin-top: vw(-4);
                }
                .btns {
                    position: absolute;
                    bottom: vw(30);
                    left: 50%;
                    transform: translateX(-50%);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    gap: vw(4);
                }
            }
        }
    }
}
.rewardModal {
    width: vw(310);
    height: vw(270);
    position: fixed;
    top: vw(60);
    right: 8%;
    @include modalLayout;
    z-index: 1000;
    padding: vw(18) vw(18);
    @include dropShadwMobile_login;
    background-image: url('/images/components/lion.png');
    background-repeat: no-repeat;
    background-position: 150% 0%;
    background-color: $sub1;
    @include ottMainDropShadow;
    h3 {
        text-align: center;
        width: vw(220);
        margin: auto;
        margin-top: vw(80);
    }
    .myreward,
    .attendance {
        strong {
            color: $main1;
            @include font-18px-SB;
            span {
                cursor: pointer;
                margin-left: vw(10);
                @include font-16px;
                text-decoration: underline;
                color: #818181;
            }
        }
    }
    .myreward {
        margin-bottom: vw(10);
        ul {
            width: 100%;
            height: vw(45);
            background: $white;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: vw(8);
            padding: 0 vw(15);
            li {
                img {
                    width: vw(15);
                }
                &:last-child {
                    span {
                        @include font-16px-SB;
                    }
                }
            }
        }
    }
    .attendance {
        position: relative;

        strong {
            span {
                cursor: pointer;
            }
        }

        .attendance-board {
            position: relative;

            ul {
                background: $white;
                border-radius: vw(8);
                width: 100%;
                height: vw(116);
                display: flex;
                justify-content: center;
                align-items: center;
                flex-wrap: wrap;
                gap: vw(12);
                padding: vw(26) vw(20);

                li {
                    background-image: url('/images/components/stamp_default.png');
                    background-position: 0 0;
                    background-repeat: no-repeat;
                    background-size: cover;
                    width: vw(35.21);
                    height: vw(24);

                    &.on {
                        background-image: url('/images/components/stamp_on.png');
                    }
                }
            }

            &.full {
                .reward-overlay {
                    position: absolute;
                    inset: 0;
                    background: rgba(0, 0, 0, 0.6); // ✅ 검은색 투명 배경
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    border-radius: vw(8);
                }

                .coupon-btn {
                    padding: vw(12) vw(24);
                    background: $main1;
                    border: none;
                    border-radius: vw(6);
                    font-weight: bold;
                    font-size: vw(16);
                    font-family: $font-main;
                    cursor: pointer;
                    color: #fff;
                    box-shadow: 0 vw(2) vw(6) rgba(0, 0, 0, 0.25);
                    transition: transform 0.2s ease, background 0.2s ease;

                    &:hover {
                        transform: scale(1.05);
                    }
                }
            }
        }
    }
}
@keyframes shake {
    0% {
        transform: translateX(0);
    }
    20% {
        transform: translateX(-4px);
    }
    40% {
        transform: translateX(4px);
    }
    60% {
        transform: translateX(-4px);
    }
    80% {
        transform: translateX(4px);
    }
    100% {
        transform: translateX(0);
    }
}
